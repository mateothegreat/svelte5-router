name: ðŸ“± Demo
on:
  workflow_dispatch:
  workflow_call:
    secrets:
      VERCEL_TOKEN:
        required: true
concurrency:
  group: demo
  cancel-in-progress: true
permissions:
  contents: read

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Harden the runner (Audit all outbound calls)
        uses: step-security/harden-runner@f4a75cfd619ee5ce8d5b864b0d183aff3c69b55a # v2.13.1
        with:
          egress-policy: audit

      - uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955 # v4.3.0
      - name: install vercel
        run: npm install --global vercel@latest
      - name: vercel pull
        run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}
      - name: vercel build
        run: vercel build --local-config demo/vercel.json --prod --token=${{ secrets.VERCEL_TOKEN }}
      - name: vercel deploy
        run: vercel deploy --local-config demo/vercel.json --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}
